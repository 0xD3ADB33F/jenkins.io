---
layout: simplepage
title: Jenkins Security Advisory 2017-03-20
section: security
kind: plugins
---

This advisory announces vulnerabilities in these Jenkins plugins:

* plugin:active-directory[Active Directory]
* plugin:distfork[DistFork]
* plugin:email-ext[Email Extension (Email-ext)]
* plugin:mailer[Mailer]
* link:https://wiki.jenkins-ci.org/display/JENKINS/Pipeline+Classpath+Step+Plugin[Pipeline: Classpath Step]
* plugin:ssh-slaves[SSH Slaves]

== Description

=== SSH Slaves Plugin did not verify host keys
*SECURITY-161 / CVE TODO*

The SSH Slaves Plugin did not perform host key verification, thereby enabling Man-in-the-Middle attacks.

=== Active Directory Plugin did not verify certificate of AD server
*SECURITY-251 / CVE TODO*

The Active Directory Plugin did not verify certificates of the Active Directory server, thereby enabling Man-in-the-Middle attacks.

=== Pipeline: Classpath Step plugin allowed Script Security sandbox bypass
*SECURITY-336 / CVE TODO*

Use of this plugin enables a bypass of the Script Security sandbox for users with SCM commit access, as well as users with e.g. Job/Configure permission in Jenkins.

=== Emails were sent to addresses not associated with actual users of Jenkins by Mailer Plugin and Email Extension Plugin
*SECURITY-372 / CVE TODO*

The Mailer and Email Extension Plugins are able to send emails to a dynamically created list of users based on the changelogs, i.e. authors of SCM changes since e.g. the last successful build.

This could in some cases result in emails being sent to people who have no user account in Jenkins, and sometimes even people who were not involved in whatever project was being built, due to some mapping based on the local-part of email addresses.

=== Missing permission checks in DistFork Plugin
*SECURITY-386 / CVE TODO*

There were no permission checks performed in the DistFork plugin that provides the `dist-fork` CLI command beyond the basic check for Overall/Read permission.

== Severity

* SECURITY-161: *link:http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L[medium]*
* SECURITY-251: *link:https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H[high]*
* SECURITY-336: *link:https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H[critical]*
* SECURITY-372: *link:https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N[low]*
* SECURITY-386: *link:https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H[critical]*

== Affected versions

* Active Directory Plugin up to and including version 2.0.
* DistFork Plugin up to and including version 1.4.1.
* Email Extension (email-ext) Plugin up to and including version 2.57.
* Mailer Plugin up to and including version 1.19.
* Pipeline: Classpath Step Plugin: All versions. No fix for this plugin is currently planned.
* SSH Slaves Plugin up to and including version 1.13.

== Fix

* Active Directory Plugin should be updated to version TODO.
* DistFork Plugin should be updated to version TODO.
* Email Extension (email-ext) Plugin should be updated to version TODO.
* Mailer Plugin should be updated to version TODO.
* SSH Slaves Plugin should be updated to version TODO.
* Pipeline: Classpath Step Plugin should be disabled or uninstalled, and its uses replaced by the link:https://jenkins.io/doc/book/pipeline/shared-libraries/[Pipeline libraries feature]. No fix for this plugin is currently planned.

These versions include fixes to the vulnerabilities described above. All prior versions are affected by these vulnerabilities.

== Credit

The Jenkins project would like to thank the following people for discovering and link:/security/#reporting-vulnerabilities[reporting] these vulnerabilities:

* *TODO* for SECURITY-161
* *Steven Christou, CloudBees, Inc.* for SECURITY-251
* *Jesse Glick, CloudBees, Inc.* for SECURITY-336
* *Caleb Tennis, CloudBees, Inc.* for SECURITY-372
* *James Nord, CloudBees, Inc.* for SECURITY-386
