<html>
<head>
<title>
Mitigating unauthenticated remote code execution 0-day in Jenkins CLI
</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<meta content='Jenkins is an open source automation server' name='description'>
<link href='/css/style.css' media='screen' rel='stylesheet'>
</head>
<body>
<a href='https://github.com/jenkinsci'>
<img alt='Fork us on GitHub' src='https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png' style='position: absolute; top: 0; right: 0; border: 0;'>
</a>
<div class='clearfloat' id='head'>
<div class='clearfloat'>
<div id='logo'>
<a href='/' title='Jenkins'>
<img src='/images/header_logo.png'>
</a>
<div id='tagline'>
An extendable open source automation server
</div>
</div>
</div>
<div class='clearfloat' id='navbar'>
<div id='page-bar'>
<ul class='menu'>
<li class='leaf first'>
<a href='/node' title='Blog landing page'>
Blog
</a>
</li>
<li class='expanded'>
<a href='/' title=''>
Connect
</a>
<ul class='menu'>
<li class='leaf first'>
<a href='/content/mailing-lists' title='Browse Jenkins mailing list archives and/or subscribe to lists'>
Mailing Lists
</a>
</li>
<li class='leaf'>
<a href='/content/chat' title='Chat with the rest of the Jenkins community on IRC'>
Chat
</a>
</li>
<li class='leaf'>
<a href='http://twitter.com/jenkinsci' title='Check out @jenkinsci on Twitter'>
Twitter
</a>
</li>
<li class='leaf'>
<a href='/content/event-calendar' title='Calendar for Jenkins events'>
Event Calendar
</a>
</li>
<li class='leaf'>
<a href='https://wiki.jenkins-ci.org/display/JENKINS/Office+Hours' title='WebEx-based online meeting'>
Office Hours
</a>
</li>
<li class='leaf last'>
<a href='https://reddit.com/r/jenkinsci' title='Check out the latest links and news on jenkinsci.reddit.com!'>
reddit
</a>
</li>
</ul>
</li>
<li class='leaf'>
<a href='https://wiki.jenkins-ci.org/display/JENKINS/Issue+Tracking' title='JIRA for Jenkins'>
Bug Tracker
</a>
</li>
<li class='leaf'>
<a href='http://wiki.jenkins-ci.org/' title='Main documentation of Jenkins'>
Wiki
</a>
</li>
<li class='leaf'>
<a href='http://ci.jenkins-ci.org/' title='Jenkins and plugins built on Jenkins'>
CI
</a>
</li>
<li class='leaf'>
<a href='https://wiki.jenkins-ci.org/display/JENKINS/Donation' title=''>
Donation
</a>
</li>
<li class='leaf last'>
<a href='/content/about-jenkins-ci' title='About Jenkins CI'>
About
</a>
</li>
</ul>
</div>
</div>

</div>
<div class='clearfloat' id='page'>
<div class='clearfloat' id='top'>
<div id='sidebar'>
<div class='block block-block even' id='block-block-5'>
<h3>
What is Jenkins?
</h3>
<div class='content'>
<p>
In a nutshell, Jenkins is the leading open source automation server.
Built with Java, it provides
<strong>
hundreds
</strong>
of plugins to support building, testing, deploying and automation
virtually any project
</p>
</div>
</div>
<div class='block block-block even' id='block-block-15'>
<h3>
Download
</h3>
<div class='content'>
This is where download content goes
</div>
</div>

<div class='block block-block even' id='block-block-15'>
<div class='content'>
<center>
<a href='http://www.wakaleo.com/books/jenkins-the-definitive-guide'>
<img alt='Jenkins: The Definitive Guide' border='0' src='http://agentdero.cachefly.net/continuousblog/images/jenkins-cover-small.png' width='220'>
</a>
<br>
<a href='http://oreilly.com/catalog/0636920010326'>
<strong>
Buy the book!
</strong>
</a>
</center>
</div>
</div>

<div class='block block-block odd' id='block-block-8'>
<h3>
Resources
</h3>
<div class='content'>
<big>
<p>
<a href='/calendar'>
Calendar
</a>
</p>
<p>
<a href='https://wiki.jenkins-ci.org/'>
Wiki
</a>
</p>
<p>
<a href='https://issues.jenkins-ci.org/'>
Issues
</a>
</p>
<p>
<a href='http://ci.jenkins-ci.org/'>
Jenkins-on-Jenkins
</a>
</p>
</big>
</div>
</div>


</div>
<div class='main-content with-sidebar' id='content'>
<div id='content-top'>
<div class='node clear-block'>
<h1>
<a href='/blog/2015/11/06/mitigating-unauthenticated-remote-code-execution-0-day-in-jenkins-cli/' title='Mitigating unauthenticated remote code execution 0-day in Jenkins CLI'>
Mitigating unauthenticated remote code execution 0-day in Jenkins CLI
</a>
</h1>
<span class='submitted'>
Published on
2015-11-06T00:00:00+00:00
</span>
<div style='float: right; clear: all;'>
<a class='twitter-share-button' data-lang='en' href='https://twitter.com/share'>
Tweet
</a>
</div>

<div class='content'>
<p><strong>Updated 2015-11-11 15:00 UTC:</strong> We have released Jenkins 1.638 and 1.625.2 which contain a fix for this vulnerability. <a href="https://wiki.jenkins-ci.org/display/SECURITY/Jenkins+Security+Advisory+2015-11-11">See the security advisory for more information about these releases</a>.</p>

<hr />

<p><strong>Updated 2015-11-06 03:55 UTC:</strong> Included a updated mitigation script which doesn't have a Jenkins boot race condition</p>

<hr />

<p>Earlier today we received numerous reports about a previously undisclosed "<a href="https://en.wikipedia.org/wiki/Zero-day_%28computing%29">zero day</a>" critical remote code execution vulnerability and exploit in Jenkins core. Unfortunately the vulnerability was not disclosed to us ahead of its publication so we're still working on more thorough fix. In the <em>meantime</em> however, we wanted to inform you of the issue and provide a workaround which will help prevent this exploit from being used against public Jenkins installations, for future reference this issue is being tracked privately as <code>SECURITY-218</code> in our <a href="https://issues.jenkins-ci.org">issue tracker</a>.</p>

<p>The attack is mounted through the <a href="https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI">Jenkins CLI</a> subsystem, so the work-around is to remove/disable the CLI support inside of the running Jenkins server.</p>

<p>Using the following Groovy script you can disable the attack vector in your Jenkins installations by navigating to “Manage Jenkins” and then to “Script Console”, or just go to <code>http://your-jenkins-installation/script</code>. This only addresses the current running Jenkins process, in order to make the workaround persist between restarts of the Jenkins server, add the script below to <code>$JENKINS_HOME/init.groovy.d/cli-shutdown.groovy</code> (create the directory if necessary, and the file).</p>

<hr />

<pre><code>import jenkins.*;
import jenkins.model.*;
import hudson.model.*;

// disabled CLI access over TCP listener (separate port)
def p = AgentProtocol.all()
p.each { x -&gt;
  if (x.name.contains("CLI")) p.remove(x)
}

// disable CLI access over /cli URL
def removal = { lst -&gt;
  lst.each { x -&gt; if (x.getClass().name.contains("CLIAction")) lst.remove(x) }
}
def j = Jenkins.instance;
removal(j.getExtensionList(RootAction.class))
removal(j.actions)
</code></pre>

<hr />
<p>in order to make the workaround persist between restarts of the Jenkins server, add the script below to <code>$JENKINS_HOME/init.groovy.d/cli-shutdown.groovy</code> (create the directory if necessary, and the file).</p>

<p>The latest version of this script can be found <a href="https://github.com/jenkinsci-cert/SECURITY-218">in this GitHub repository</a>.</p>

<p>As previously announced on the <a href="https://groups.google.com/d/forum/jenkinsci-advisories">jenkinsci-advisories</a> mailing list we’re preparing a security release for this upcoming Wednesday which will include patches for both the latest and LTS lines of Jenkins core. The Jenkins Security team is working to include a fix for this previously undisclosed exploit in or before this planned security release.</p>

<p>If you have questions about this exploit, join us in the <a href="http://webchat.freenode.net/?channels=%23jenkins&amp;uio=d4">#jenkins channel on Freenode</a> or ask on the <a href="https://groups.google.com/d/forum/jenkinsci-users">jenkinsci-users@ mailing list</a>.</p>

<p>For security researchers and hobbyists, if you believe you have found a security vulnerability in Jenkins, we have some disclosure guidelines <a href="https://wiki.jenkins-ci.org/display/JENKINS/Security+Advisories">on this wiki page</a> which will help us mitigate any discovered issues as quickly and safely as possible.</p>

<hr />

<p>Be sure to subscribe to the jenkinsci-advisories mailing list (<a href="https://groups.google.com/d/forum/jenkinsci-advisories">jenkinsci-advisories</a>), it's the fastest way to get updates by the Jenkins Security team.</p>

</div>
</div>

<div id='content-bottom'>
</div>
</div>
<script>
  !function(d,s,id) {
    var js, fjs=d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
      js = d.createElement(s);
      js.id=id;
      js.src="//platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js,fjs);
    }
  }(document,"script","twitter-wjs");
</script>

<div id='github'>
<a href='https://github.com/rtyler/jenkins.io/edit/master/content//blog/2015/2015-11-06-mitigating-unauthenticated-remote-code-execution-0-day-in-jenkins-cli.md' title='Edit /blog/2015/2015-11-06-mitigating-unauthenticated-remote-code-execution-0-day-in-jenkins-cli.md on GitHub'>
Improve this page
</a>
</div>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){

                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),

                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)

                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-4216293-5', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

</body>
</html>
